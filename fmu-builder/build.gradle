plugins {
    id 'java'
    id 'kotlin'
    id 'application'
    id 'distribution'
    id "com.github.johnrengelman.shadow" version "4.0.4"
}

apply from: rootProject.file("gradle/junit.gradle")

def group = "no.ntnu.ihb.fmi4j"
mainClassName = "${group}.FmuBuilder"

dependencies {

    compile project(':fmi-md')
    compile group: 'info.picocli', name: 'picocli', version: '3.9.2'

    testCompile project(':fmi-import')
    testCompile project(':fmi-export')

}

task testJar(type: Jar) {
    classifier = null
    archiveBaseName.set("fmu-slaves")
    from sourceSets.test.output.classesDirs + configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } + configurations.testCompile.collect { it.isDirectory() ? it : zipTree(it) }
}

shadowJar {
    archiveBaseName.set("fmu-builder")
    classifier = null
    version = null
}

distributions {
    main {
        baseName = 'fmu-builder'
    }
}

startScripts {
    applicationName = 'fmu-builder'
}

test.dependsOn(testJar)
