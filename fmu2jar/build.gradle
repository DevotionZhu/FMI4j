
def group = "no.mechatronics.sfi.fmu2jar"
def version = "1.0-SNAPSHOT"
def fmuName = "ControlledTemperature"
def jar = new File(System.getProperty("user.home") + "/.m2/repository/${group.replace(".", "/")}/${fmuName.toLowerCase()}/$version/${fmuName}-${version}.jar")

def debug = jar.exists()

apply plugin: 'kotlin'
apply plugin: 'application'

mainClassName = "${group}.Main"

repositories {

    if (debug) {
        mavenLocal()
    }

}

configurations.all {
    resolutionStrategy.cacheChangingModulesFor 0, 'seconds'
}

dependencies {

    compile "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
    compile group: 'commons-cli', name: 'commons-cli', version: '1.4'

    compile project(':fmi-modeldescription')

    if (debug) {
        testCompile group: "$group", name: "$fmuName", version: "$version", changing: true
    } else {
        testCompile project(':fmi-import')
    }

}

sourceSets {
    test {
        java {
            if (!debug) {
                exclude '**/ControlledTemperatureTest.java'
            }
        }
        kotlin {
            if (!debug) {
                exclude '**/ControlledTemperatureTest_kt.kt'
            }
        }
    }
}