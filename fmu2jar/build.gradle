
apply plugin: 'application'
apply plugin: 'distribution'

mainClassName = 'no.mechatronics.sfi.fmu2jar.ApplicationStarter'

distributions {
    main {
        baseName = 'FMU2Jar'
        applicationName = "fmu2jar"
    }
}

def debug = false
def snapshot = false

def fmi_md_version = snapshot ? '0.4.4-SNAPSHOT' : '0.4.3'

repositories {
    if (debug) {
        mavenLocal()
    }
    if (snapshot) {
        maven {
            url "https://oss.sonatype.org/content/repositories/snapshots/" //fmi-import
        }
    }
}

dependencies {

    compile group: 'commons-cli', name: 'commons-cli', version: '1.4'
    compile group: 'no.mechatronics.sfi.fmi4j', name: 'fmi-md', version: fmi_md_version

    testCompile group: 'commons-io', name: 'commons-io', version: '2.6'

    if (debug) {
        dependencies {
            testCompile group: 'no.mechatronics.sfi.fmu2jar', name: "ControlledTemperature", "version": "1.0-SNAPSHOT", changing: true
        }
    }

}

sourceSets {
    test {
        java {
            if (!debug) {
                exclude '**/ControlledTemperatureTest.java'
            }
        }
    }
}


//task fatJar(type: Jar) {
//    manifest {
//        attributes 'Implementation-Title': 'FMU2Jar',
//                'Implementation-Version': "1.0",
//                'Main-Class': 'no.mechatronics.sfi.fmu2jar.ApplicationStarter'
//    }
//    baseName = 'FMU2Jar'
//    from {
//        configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
//    }
//    with jar
//}


